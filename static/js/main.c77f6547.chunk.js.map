{"version":3,"sources":["classes/ModelClass.ts","libs/MMDLoader.js","components/ModelControl.tsx","components/ModelView.tsx","components/BoneControl.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["ModelClass","id","mesh","modelName","comment","this","MMDLoader","manager","Loader","call","loader","FileLoader","parser","fileArray","meshBuilder","MeshBuilder","animationBuilder","AnimationBuilder","prototype","Object","assign","create","constructor","setAnimationPath","animationPath","readFileAsDataURL","file","a","Promise","resolve","fileReader","FileReader","onload","e","result","readAsDataURL","result_base64","loadFromDir","dirHandle","onLoad","onProgress","onError","builder","setCrossOrigin","crossOrigin","name","entry","getFile","_extractExtension","toLowerCase","loadPMXFromFile","data","buildDir","load","url","resourcePath","path","LoaderUtils","extractUrlBase","modelExtension","build","Error","loadAnimation","object","loadVMD","vmd","isCamera","buildCameraAnimation","loadWithAnimation","modelUrl","vmdUrl","scope","animation","loadPMD","_getParser","setMimeType","undefined","setPath","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","buffer","parsePmd","loadPMX","parsePmx","reader","readAsArrayBuffer","urls","Array","isArray","vmds","vmdNum","length","i","il","push","parseVmd","mergeVmds","loadVPD","isUnicode","text","parseVpd","index","lastIndexOf","slice","MMDParser","Parser","DEFAULT_TOON_TEXTURES","geometryBuilder","GeometryBuilder","materialBuilder","MaterialBuilder","initBones","bone","gbone","geometry","bones","Bone","position","fromArray","pos","quaternion","rotq","scl","scale","parent","add","updateMatrixWorld","textureLoader","TextureLoader","tgaLoader","CubicBezierInterpolation","parameterPositions","sampleValues","sampleSize","resultBuffer","params","Interpolant","interpolationParams","material","setResourcePath","SkinnedMesh","skeleton","Skeleton","bind","dir","setResourceDir","positions","uvs","normals","indices","groups","skinIndices","skinWeights","morphTargets","morphPositions","iks","grants","rigidBodies","constraints","offset","boneTypeTable","metadata","vertexCount","v","vertices","j","jl","normal","uv","faceCount","face","faces","materialCount","materials","count","rigidBodyCount","body","value","boneIndex","type","Math","max","boneCount","boneData","parentIndex","rigidBodyType","format","ikCount","param","target","ik","effector","iteration","maxAngle","links","link","enabled","indexOf","limitation","Vector3","angleLimitation","rotationMin","lowerLimitationAngle","rotationMax","upperLimitationAngle","tmp1","tmp2","grant","ratio","isLocal","affectRotation","affectPosition","transformationClass","sort","b","updateAttributes","attribute","morph","elementCount","element","elements","morphs","array","morphCount","Float32BufferAttribute","morph2","console","log","rigidBody","key","constraintCount","constraint","bodyA","rigidBodyIndex1","bodyB","rigidBodyIndex2","BufferGeometry","setAttribute","Uint16BufferAttribute","setIndex","addGroup","morphAttributes","morphTargetsRelative","userData","MMD","frames","englishModelName","englishComment","computeBoundingSphere","resourceDir","textures","color","Color","diffuse","opacity","emissive","ambient","transparent","skinning","fog","blending","CustomBlending","blendSrc","SrcAlphaFactor","blendDst","OneMinusSrcAlphaFactor","blendSrcAlpha","blendDstAlpha","DstAlphaFactor","flag","side","DoubleSide","FrontSide","fileName","fileNames","split","map","_loadTexture","extension","envMap","combine","MultiplyOperation","AddOperation","toonFileName","toonIndex","toonTextures","gradientMap","isToonTexture","isDefaultToonTexture","_isDefaultToonTexture","outlineParameters","thickness","edgeFlag","alpha","visible","isDefaultToon","textureIndex","envTextureIndex","envFlag","toonFlag","edgeSize","edgeColor","_checkImageTransparency","multiplyScalar","MeshToonMaterial","checkAlphaMorph","_getTGALoader","TGALoader","test","filePath","fullPath","parseInt","match","warn","getHandler","texture","t","image","_getRotatedImage","magFilter","NearestFilter","minFilter","flipY","wrapS","RepeatWrapping","wrapT","readyCallbacks","canvas","document","createElement","context","getContext","width","height","clearRect","translate","rotate","PI","drawImage","getImageData","groupIndex","getAlphaByUv","x","round","y","imageData","createImageData","group","centerUV","detectImageTransparency","attributes","start","tracks","buildSkeletalAnimation","tracks2","buildMorphAnimation","AnimationClip","pushInterpolation","interpolation","motions","boneNameDictionary","motionCount","motion","boneName","frameNum","times","rotations","pInterpolations","rInterpolations","basePosition","getBoneByName","toArray","time","rotation","targetName","_createTrack","VectorKeyframeTrack","QuaternionKeyframeTrack","morphTargetDictionary","morphName","values","weight","NumberKeyframeTrack","pushVector3","vec","z","cameras","q","centers","quaternions","fovs","cInterpolations","qInterpolations","fInterpolations","Quaternion","euler","Euler","center","rot","distance","fov","set","setFromEuler","applyQuaternion","w","node","typedKeyframeTrack","interpolations","stride","interpolateStride","aheadIndex","endIndex","track","createInterpolant","getValueSize","Float32Array","interpolate_","i1","t0","t1","valueSize","offset1","offset0","weight1","x1","x2","y1","y2","_calculate","slerpFlat","sst3","stt3","ttt","c","s","math","ft","abs","useStyles","makeStyles","theme","createStyles","formControl","margin","spacing","minWidth","selectEmpty","marginTop","ModelControl","props","classes","window","showDirectoryPicker","m","models","newModels","newActiveId","activeModelId","alert","setModels","setActiveModelId","error","style","textAlign","fontSize","padding","FormControl","variant","className","Select","onChange","event","native","model","Button","onClick","filter","ModelView","useRef","orbit","transform","scene","useThree","useState","ikHepler","setIkHelper","useEffect","current","controls","callback","modelClass","attach","selectObject","controlMode","helper","CCDIKSolver","createHelper","detach","setMode","addEventListener","removeEventListener","TransformControls","ref","dispose","OrbitControls","BoneControl","setControl","mode","setControlMode","root","flexGrow","menuButton","marginRight","title","App","React","anchorEl","setAnchorEl","open","Boolean","AppBar","Toolbar","Typography","p","IconButton","aria-label","aria-controls","aria-haspopup","currentTarget","Menu","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","onClose","MenuItem","Grid","container","item","xs","backgroundColor","colorManagement","camera","fallback","border","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.c77f6547.chunk.js","sourcesContent":["import { SkinnedMesh } from 'three';\nexport class ModelClass{\n    public id:number;\n    public mesh: SkinnedMesh | null;\n    public modelName: string | null;\n    public comment: string | null;\n    constructor(id:number){\n        this.id = id;\n        this.mesh = null;\n        this.modelName = null;\n        this.comment = null;\n    }\n}\n","import {\n\tAddOperation,\n\tAnimationClip,\n\tBone,\n\tBufferGeometry,\n\tColor,\n\tCustomBlending,\n\tDoubleSide,\n\tDstAlphaFactor,\n\tEuler,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tFrontSide,\n\tInterpolant,\n\tLoader,\n\tLoaderUtils,\n\tMeshToonMaterial,\n\tMultiplyOperation,\n\tNearestFilter,\n\tNumberKeyframeTrack,\n\tOneMinusSrcAlphaFactor,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSrcAlphaFactor,\n\tTextureLoader,\n\tUint16BufferAttribute,\n\tVector3,\n\tVectorKeyframeTrack\n} from \"three\";\nimport { TGALoader } from \"../../node_modules/three/examples/jsm/loaders/TGALoader.js\";\nimport { MMDParser } from \"../../node_modules/three/examples/jsm/libs/mmdparser.module\";\n\n/**\n * Dependencies\n *  - mmd-parser https://github.com/takahirox/mmd-parser\n *  - TGALoader\n *  - OutlineEffect\n *\n * MMDLoader creates Three.js Objects from MMD resources as\n * PMD, PMX, VMD, and VPD files.\n *\n * PMD/PMX is a model data format, VMD is a motion data format\n * VPD is a posing data format used in MMD(Miku Miku Dance).\n *\n * MMD official site\n *  - https://sites.google.com/view/evpvp/\n *\n * PMD, VMD format (in Japanese)\n *  - http://blog.goo.ne.jp/torisu_tetosuki/e/209ad341d3ece2b1b4df24abf619d6e4\n *\n * PMX format\n *  - https://gist.github.com/felixjones/f8a06bd48f9da9a4539f\n *\n * TODO\n *  - light motion in vmd support.\n *  - SDEF support.\n *  - uv/material/bone morphing support.\n *  - more precise grant skinning support.\n *  - shadow support.\n */\n\nvar MMDLoader = ( function () {\n\n\t/**\n\t * @param {THREE.LoadingManager} manager\n\t */\n\tfunction MMDLoader( manager ) {\n\n\t\tLoader.call( this, manager );\n\n\t\tthis.loader = new FileLoader( this.manager );\n\n\t\tthis.parser = null; // lazy generation\n\t\tthis.fileArray = [];\n\t\tthis.meshBuilder = new MeshBuilder( this.manager );\n\t\tthis.animationBuilder = new AnimationBuilder();\n\n\t}\n\n\tMMDLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\t\tconstructor: MMDLoader,\n\n\t\t/**\n\t\t * @param {string} animationPath\n\t\t * @return {MMDLoader}\n\t\t */\n\t\tsetAnimationPath: function ( animationPath ) {\n\n\t\t\tthis.animationPath = animationPath;\n\t\t\treturn this;\n\n\t\t},\n\n\t\t// Load MMD assets as Three.js Object\n\t\treadFileAsDataURL: async function(file) {\n\t\t\tlet result_base64 = await new Promise((resolve) => {\n\t\t\t\tlet fileReader = new FileReader();\n\t\t\t\tfileReader.onload = (e) => resolve(fileReader.result);\n\t\t\t\tfileReader.readAsDataURL(file);\n\t\t\t});\n\t\t\treturn result_base64;\n\t\t},\n\t\tloadFromDir: async function(dirHandle, onLoad, onProgress, onError ){\n\t\t\tvar builder = this.meshBuilder.setCrossOrigin( this.crossOrigin );\n\t\t\tfor await(var [name, entry] of dirHandle) {\n\t\t\t\tvar file = await entry.getFile();\n\t\t\t\tthis.fileArray[name] = await this.readFileAsDataURL(file);\n\t\t\t}\n\t\t\tfor await(var [name, entry] of dirHandle) {\n\t\t\t\tvar modelExtension = this._extractExtension(name).toLowerCase();\n\t\t\t\tif(modelExtension === 'pmx') {\n\t\t\t\t\tconst file = await entry.getFile();\n\t\t\t\t\tthis.loadPMXFromFile(file,(data) => {\n\t\t\t\t\t\tonLoad(builder.buildDir( data, this.fileArray, null, null));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t},\n\n\t\t/**\n\t\t * Loads Model file (.pmd or .pmx) as a SkinnedMesh.\n\t\t *\n\t\t * @param {string} url - url to Model(.pmd or .pmx) file\n\t\t * @param {function} onLoad\n\t\t * @param {function} onProgress\n\t\t * @param {function} onError\n\t\t */\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\t\t\tvar builder = this.meshBuilder.setCrossOrigin( this.crossOrigin );\n\n\t\t\t// resource path\n\n\t\t\tvar resourcePath;\n\n\t\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\t\tresourcePath = this.resourcePath;\n\n\t\t\t} else if ( this.path !== '' ) {\n\n\t\t\t\tresourcePath = this.path;\n\n\t\t\t} else {\n\n\t\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t\t}\n\n\t\t\tvar modelExtension = this._extractExtension( url ).toLowerCase();\n\n\t\t\t// Should I detect by seeing header?\n\t\t\tif ( modelExtension !== 'pmd' && modelExtension !== 'pmx' ) {\n\n\t\t\t\tif ( onError ) onError( new Error( 'THREE.MMDLoader: Unknown model file extension .' + modelExtension + '.' ) );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tthis[ modelExtension === 'pmd' ? 'loadPMD' : 'loadPMX' ]( url, function ( data ) {\n\n\t\t\t\tonLoad(\tbuilder.build( data, resourcePath, onProgress, onError )\t);\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\t/**\n\t\t * Loads Motion file(s) (.vmd) as a AnimationClip.\n\t\t * If two or more files are specified, they'll be merged.\n\t\t *\n\t\t * @param {string|Array<string>} url - url(s) to animation(.vmd) file(s)\n\t\t * @param {SkinnedMesh|THREE.Camera} object - tracks will be fitting to this object\n\t\t * @param {function} onLoad\n\t\t * @param {function} onProgress\n\t\t * @param {function} onError\n\t\t */\n\t\tloadAnimation: function ( url, object, onLoad, onProgress, onError ) {\n\n\t\t\tvar builder = this.animationBuilder;\n\n\t\t\tthis.loadVMD( url, function ( vmd ) {\n\n\t\t\t\tonLoad( object.isCamera\n\t\t\t\t\t? builder.buildCameraAnimation( vmd )\n\t\t\t\t\t: builder.build( vmd, object ) );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\t/**\n\t\t * Loads mode file and motion file(s) as an object containing\n\t\t * a SkinnedMesh and a AnimationClip.\n\t\t * Tracks of AnimationClip are fitting to the model.\n\t\t *\n\t\t * @param {string} modelUrl - url to Model(.pmd or .pmx) file\n\t\t * @param {string|Array{string}} vmdUrl - url(s) to animation(.vmd) file\n\t\t * @param {function} onLoad\n\t\t * @param {function} onProgress\n\t\t * @param {function} onError\n\t\t */\n\t\tloadWithAnimation: function ( modelUrl, vmdUrl, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tthis.load( modelUrl, function ( mesh ) {\n\n\t\t\t\tscope.loadAnimation( vmdUrl, mesh, function ( animation ) {\n\n\t\t\t\t\tonLoad( {\n\t\t\t\t\t\tmesh: mesh,\n\t\t\t\t\t\tanimation: animation\n\t\t\t\t\t} );\n\n\t\t\t\t}, onProgress, onError );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\t// Load MMD assets as Object data parsed by MMDParser\n\n\t\t/**\n\t\t * Loads .pmd file as an Object.\n\t\t *\n\t\t * @param {string} url - url to .pmd file\n\t\t * @param {function} onLoad\n\t\t * @param {function} onProgress\n\t\t * @param {function} onError\n\t\t */\n\t\tloadPMD: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar parser = this._getParser();\n\n\t\t\tthis.loader\n\t\t\t\t.setMimeType( undefined )\n\t\t\t\t.setPath( this.path )\n\t\t\t\t.setResponseType( 'arraybuffer' )\n\t\t\t\t.setRequestHeader( this.requestHeader )\n\t\t\t\t.setWithCredentials( this.withCredentials )\n\t\t\t\t.load( url, function ( buffer ) {\n\n\t\t\t\t\tonLoad( parser.parsePmd( buffer, true ) );\n\n\t\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\t/**\n\t\t * Loads .pmx file as an Object.\n\t\t *\n\t\t * @param {string} url - url to .pmx file\n\t\t * @param {function} onLoad\n\t\t * @param {function} onProgress\n\t\t * @param {function} onError\n\t\t */\n\t\tloadPMX: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar parser = this._getParser();\n\n\t\t\tthis.loader\n\t\t\t\t.setMimeType( undefined )\n\t\t\t\t.setPath( this.path )\n\t\t\t\t.setResponseType( 'arraybuffer' )\n\t\t\t\t.setRequestHeader( this.requestHeader )\n\t\t\t\t.setWithCredentials( this.withCredentials )\n\t\t\t\t.load( url, function ( buffer ) {\n\n\t\t\t\t\tonLoad( parser.parsePmx( buffer, true ) );\n\n\t\t\t\t}, onProgress, onError );\n\n\t\t},\n\t\tloadPMXFromFile: function ( file, onLoad, onProgress, onError ) {\n\t\t\tvar parser = this._getParser();\n\t\t\tlet reader = new FileReader();\n\t\t\treader.onload = function () {\n\t\t\t\tonLoad( parser.parsePmx( reader.result, true ) );\n\t\t\t}\n\t\t\treader.readAsArrayBuffer(file);\n\t\t},\n\n\t\t/**\n\t\t * Loads .vmd file as an Object. If two or more files are specified\n\t\t * they'll be merged.\n\t\t *\n\t\t * @param {string|Array<string>} url - url(s) to .vmd file(s)\n\t\t * @param {function} onLoad\n\t\t * @param {function} onProgress\n\t\t * @param {function} onError\n\t\t */\n\t\tloadVMD: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar urls = Array.isArray( url ) ? url : [ url ];\n\n\t\t\tvar vmds = [];\n\t\t\tvar vmdNum = urls.length;\n\n\t\t\tvar parser = this._getParser();\n\n\t\t\tthis.loader\n\t\t\t\t.setMimeType( undefined )\n\t\t\t\t.setPath( this.animationPath )\n\t\t\t\t.setResponseType( 'arraybuffer' )\n\t\t\t\t.setRequestHeader( this.requestHeader )\n\t\t\t\t.setWithCredentials( this.withCredentials );\n\n\t\t\tfor ( var i = 0, il = urls.length; i < il; i ++ ) {\n\n\t\t\t\tthis.loader.load( urls[ i ], function ( buffer ) {\n\n\t\t\t\t\tvmds.push( parser.parseVmd( buffer, true ) );\n\n\t\t\t\t\tif ( vmds.length === vmdNum ) onLoad( parser.mergeVmds( vmds ) );\n\n\t\t\t\t}, onProgress, onError );\n\n\t\t\t}\n\n\t\t},\n\n\t\t/**\n\t\t * Loads .vpd file as an Object.\n\t\t *\n\t\t * @param {string} url - url to .vpd file\n\t\t * @param {boolean} isUnicode\n\t\t * @param {function} onLoad\n\t\t * @param {function} onProgress\n\t\t * @param {function} onError\n\t\t */\n\t\tloadVPD: function ( url, isUnicode, onLoad, onProgress, onError ) {\n\n\t\t\tvar parser = this._getParser();\n\n\t\t\tthis.loader\n\t\t\t\t.setMimeType( isUnicode ? undefined : 'text/plain; charset=shift_jis' )\n\t\t\t\t.setPath( this.animationPath )\n\t\t\t\t.setResponseType( 'text' )\n\t\t\t\t.setRequestHeader( this.requestHeader )\n\t\t\t\t.setWithCredentials( this.withCredentials )\n\t\t\t\t.load( url, function ( text ) {\n\n\t\t\t\t\tonLoad( parser.parseVpd( text, true ) );\n\n\t\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\t// private methods\n\n\t\t_extractExtension: function ( url ) {\n\n\t\t\tvar index = url.lastIndexOf( '.' );\n\t\t\treturn index < 0 ? '' : url.slice( index + 1 );\n\n\t\t},\n\n\t\t_getParser: function () {\n\n\t\t\tif ( this.parser === null ) {\n\n\t\t\t\tif ( typeof MMDParser === 'undefined' ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.MMDLoader: Import MMDParser https://github.com/takahirox/mmd-parser' );\n\n\t\t\t\t}\n\n\t\t\t\tthis.parser = new MMDParser.Parser(); // eslint-disable-line no-undef\n\n\t\t\t}\n\n\t\t\treturn this.parser;\n\n\t\t}\n\n\t} );\n\n\t// Utilities\n\n\t/*\n\t * base64 encoded defalut toon textures toon00.bmp - toon10.bmp.\n\t * We don't need to request external toon image files.\n\t * This idea is from http://www20.atpages.jp/katwat/three.js_r58/examples/mytest37/mmd.three.js\n\t */\n\tvar DEFAULT_TOON_TEXTURES = [\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/bWiiMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh8aBHZBl14e8wAAAABJRU5ErkJggg==',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOUlEQVRYR+3WMREAMAwDsYY/yoDI7MLwIiP40+RJklfcCCBAgAABAgTqArfb/QMCCBAgQIAAgbbAB3z/e0F3js2cAAAAAElFTkSuQmCC',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/B5ilMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh81dWyx0gFwKAAAAABJRU5ErkJggg==',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOklEQVRYR+3WoREAMAwDsWb/UQtCy9wxTOQJ/oQ8SXKKGwEECBAgQIBAXeDt7f4BAQQIECBAgEBb4AOz8Hzx7WLY4wAAAABJRU5ErkJggg==',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPUlEQVRYR+1XwW7CMAy1+f9fZOMysSEOEweEOPRNdm3HbdOyIhAcklPrOs/PLy9RygBALxzcCDQFmgJNgaZAU6Ap0BR4PwX8gsRMVLssMRH5HcpzJEaWL7EVg9F1IHRlyqQohgVr4FGUlUcMJSjcUlDw0zvjeun70cLWmneoyf7NgBTQSniBTQQSuJAZsOnnaczjIMb5hCiuHKxokCrJfVnrctyZL0PkJAJe1HMil4nxeyi3Ypfn1kX51jpPvo/JeCNC4PhVdHdJw2XjBR8brF8PEIhNVn12AgP7uHsTBguBn53MUZCqv7Lp07Pn5k1Ro+uWmUNn7D+M57rtk7aG0Vo73xyF/fbFf0bPJjDXngnGocDTdFhygZjwUQrMNrDcmZlQT50VJ/g/UwNyHpu778+yW+/ksOz/BFo54P4AsUXMfRq7XWsAAAAASUVORK5CYII=',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACMElEQVRYR+2Xv4pTQRTGf2dubhLdICiii2KnYKHVolhauKWPoGAnNr6BD6CvIVaihYuI2i1ia0BY0MZGRHQXjZj/mSPnnskfNWiWZUlzJ5k7M2cm833nO5Mziej2DWWJRUoCpQKlAntSQCqgw39/iUWAGmh37jrRnVsKlgpiqmkoGVABA7E57fvY+pJDdgKqF6HzFCSADkDq+F6AHABtQ+UMVE5D7zXod7fFNhTEckTbj5XQgHzNN+5tQvc5NG7C6BNkp6D3EmpXHDR+dQAjFLchW3VS9rlw3JBh+B7ys5Cf9z0GW1C/7P32AyBAOAz1q4jGliIH3YPuBnSfQX4OGreTIgEYQb/pBDtPnEQ4CivXYPAWBk13oHrB54yA9QuSn2H4AcKRpEILDt0BUzj+RLR1V5EqjD66NPRBVpLcQwjHoHYJOhsQv6U4mnzmrIXJCFr4LDwm/xBUoboG9XX4cc9VKdYoSA2yk5NQLJaKDUjTBoveG3Z2TElTxwjNK4M3LEZgUdDdruvcXzKBpStgp2NPiWi3ks9ZXxIoFVi+AvHLdc9TqtjL3/aYjpPlrzOcEnK62Szhimdd7xX232zFDTgtxezOu3WNMRLjiKgjtOhHVMd1loynVHvOgjuIIJMaELEqhJAV/RCSLbWTcfPFakFgFlALTRRvx+ok6Hlp/Q+v3fmx90bMyUzaEAhmM3KvHlXTL5DxnbGf/1M8RNNACLL5MNtPxP/mypJAqcDSFfgFhpYqWUzhTEAAAAAASUVORK5CYII=',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=',\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII='\n\t];\n\n\t// Builders. They build Three.js object from Object data parsed by MMDParser.\n\n\t/**\n\t * @param {THREE.LoadingManager} manager\n\t */\n\tfunction MeshBuilder( manager ) {\n\n\t\tthis.geometryBuilder = new GeometryBuilder();\n\t\tthis.materialBuilder = new MaterialBuilder( manager );\n\n\t}\n\n\tMeshBuilder.prototype = {\n\n\t\tconstructor: MeshBuilder,\n\n\t\tcrossOrigin: 'anonymous',\n\n\t\t/**\n\t\t * @param {string} crossOrigin\n\t\t * @return {MeshBuilder}\n\t\t */\n\t\tsetCrossOrigin: function ( crossOrigin ) {\n\n\t\t\tthis.crossOrigin = crossOrigin;\n\t\t\treturn this;\n\n\t\t},\n\n\t\t/**\n\t\t * @param {Object} data - parsed PMD/PMX data\n\t\t * @param {string} resourcePath\n\t\t * @param {function} onProgress\n\t\t * @param {function} onError\n\t\t * @return {SkinnedMesh}\n\t\t */\n\t\tbuild: function ( data, resourcePath, onProgress, onError ) {\n\n\t\t\tvar geometry = this.geometryBuilder.build( data );\n\t\t\tvar material = this.materialBuilder\n\t\t\t\t.setCrossOrigin( this.crossOrigin )\n\t\t\t\t.setResourcePath( resourcePath )\n\t\t\t\t.build( data, geometry, onProgress, onError );\n\n\t\t\tvar mesh = new SkinnedMesh( geometry, material );\n\n\t\t\tvar skeleton = new Skeleton( initBones( mesh ) );\n\t\t\tmesh.bind( skeleton );\n\n\t\t\t// console.log( mesh ); // for console debug\n\n\t\t\treturn mesh;\n\n\t\t},\n\n\t\tbuildDir: function (data, dir, onProgress, onError ) {\n\t\t\tvar geometry = this.geometryBuilder.build( data );\n\t\t\tvar material = this.materialBuilder\n\t\t\t\t.setCrossOrigin( this.crossOrigin )\n\t\t\t\t.setResourceDir( dir )\n\t\t\t\t.build( data, geometry, onProgress, onError );\n\n\t\t\tvar mesh = new SkinnedMesh( geometry, material );\n\n\t\t\tvar skeleton = new Skeleton( initBones( mesh ) );\n\t\t\tmesh.bind( skeleton );\n\t\t\treturn mesh;\n\t\t}\n\n\t};\n\n\t// TODO: Try to remove this function\n\n\tfunction initBones( mesh ) {\n\n\t\tvar geometry = mesh.geometry;\n\n\t\tvar bones = [], bone, gbone;\n\t\tvar i, il;\n\n\t\tif ( geometry && geometry.bones !== undefined ) {\n\n\t\t\t// first, create array of 'Bone' objects from geometry data\n\n\t\t\tfor ( i = 0, il = geometry.bones.length; i < il; i ++ ) {\n\n\t\t\t\tgbone = geometry.bones[ i ];\n\n\t\t\t\t// create new 'Bone' object\n\n\t\t\t\tbone = new Bone();\n\t\t\t\tbones.push( bone );\n\n\t\t\t\t// apply values\n\n\t\t\t\tbone.name = gbone.name;\n\t\t\t\tbone.position.fromArray( gbone.pos );\n\t\t\t\tbone.quaternion.fromArray( gbone.rotq );\n\t\t\t\tif ( gbone.scl !== undefined ) bone.scale.fromArray( gbone.scl );\n\n\t\t\t}\n\n\t\t\t// second, create bone hierarchy\n\n\t\t\tfor ( i = 0, il = geometry.bones.length; i < il; i ++ ) {\n\n\t\t\t\tgbone = geometry.bones[ i ];\n\n\t\t\t\tif ( ( gbone.parent !== - 1 ) && ( gbone.parent !== null ) && ( bones[ gbone.parent ] !== undefined ) ) {\n\n\t\t\t\t\t// subsequent bones in the hierarchy\n\n\t\t\t\t\tbones[ gbone.parent ].add( bones[ i ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// topmost bone, immediate child of the skinned mesh\n\n\t\t\t\t\tmesh.add( bones[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// now the bones are part of the scene graph and children of the skinned mesh.\n\t\t// let's update the corresponding matrices\n\n\t\tmesh.updateMatrixWorld( true );\n\n\t\treturn bones;\n\n\t}\n\n\t//\n\n\tfunction GeometryBuilder() {\n\n\t}\n\n\tGeometryBuilder.prototype = {\n\n\t\tconstructor: GeometryBuilder,\n\n\t\t/**\n\t\t * @param {Object} data - parsed PMD/PMX data\n\t\t * @return {BufferGeometry}\n\t\t */\n\t\tbuild: function ( data ) {\n\n\t\t\t// for geometry\n\t\t\tvar positions = [];\n\t\t\tvar uvs = [];\n\t\t\tvar normals = [];\n\n\t\t\tvar indices = [];\n\n\t\t\tvar groups = [];\n\n\t\t\tvar bones = [];\n\t\t\tvar skinIndices = [];\n\t\t\tvar skinWeights = [];\n\n\t\t\tvar morphTargets = [];\n\t\t\tvar morphPositions = [];\n\n\t\t\tvar iks = [];\n\t\t\tvar grants = [];\n\n\t\t\tvar rigidBodies = [];\n\t\t\tvar constraints = [];\n\n\t\t\t// for work\n\t\t\tvar offset = 0;\n\t\t\tvar boneTypeTable = {};\n\n\t\t\t// positions, normals, uvs, skinIndices, skinWeights\n\n\t\t\tfor ( var i = 0; i < data.metadata.vertexCount; i ++ ) {\n\n\t\t\t\tvar v = data.vertices[ i ];\n\n\t\t\t\tfor ( var j = 0, jl = v.position.length; j < jl; j ++ ) {\n\n\t\t\t\t\tpositions.push( v.position[ j ] );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = v.normal.length; j < jl; j ++ ) {\n\n\t\t\t\t\tnormals.push( v.normal[ j ] );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = v.uv.length; j < jl; j ++ ) {\n\n\t\t\t\t\tuvs.push( v.uv[ j ] );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0; j < 4; j ++ ) {\n\n\t\t\t\t\tskinIndices.push( v.skinIndices.length - 1 >= j ? v.skinIndices[ j ] : 0.0 );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0; j < 4; j ++ ) {\n\n\t\t\t\t\tskinWeights.push( v.skinWeights.length - 1 >= j ? v.skinWeights[ j ] : 0.0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// indices\n\n\t\t\tfor ( var i = 0; i < data.metadata.faceCount; i ++ ) {\n\n\t\t\t\tvar face = data.faces[ i ];\n\n\t\t\t\tfor ( var j = 0, jl = face.indices.length; j < jl; j ++ ) {\n\n\t\t\t\t\tindices.push( face.indices[ j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// groups\n\n\t\t\tfor ( var i = 0; i < data.metadata.materialCount; i ++ ) {\n\n\t\t\t\tvar material = data.materials[ i ];\n\n\t\t\t\tgroups.push( {\n\t\t\t\t\toffset: offset * 3,\n\t\t\t\t\tcount: material.faceCount * 3\n\t\t\t\t} );\n\n\t\t\t\toffset += material.faceCount;\n\n\t\t\t}\n\n\t\t\t// bones\n\n\t\t\tfor ( var i = 0; i < data.metadata.rigidBodyCount; i ++ ) {\n\n\t\t\t\tvar body = data.rigidBodies[ i ];\n\t\t\t\tvar value = boneTypeTable[ body.boneIndex ];\n\n\t\t\t\t// keeps greater number if already value is set without any special reasons\n\t\t\t\tvalue = value === undefined ? body.type : Math.max( body.type, value );\n\n\t\t\t\tboneTypeTable[ body.boneIndex ] = value;\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < data.metadata.boneCount; i ++ ) {\n\n\t\t\t\tvar boneData = data.bones[ i ];\n\n\t\t\t\tvar bone = {\n\t\t\t\t\tparent: boneData.parentIndex,\n\t\t\t\t\tname: boneData.name,\n\t\t\t\t\tpos: boneData.position.slice( 0, 3 ),\n\t\t\t\t\trotq: [ 0, 0, 0, 1 ],\n\t\t\t\t\tscl: [ 1, 1, 1 ],\n\t\t\t\t\trigidBodyType: boneTypeTable[ i ] !== undefined ? boneTypeTable[ i ] : - 1\n\t\t\t\t};\n\n\t\t\t\tif ( bone.parent !== - 1 ) {\n\n\t\t\t\t\tbone.pos[ 0 ] -= data.bones[ bone.parent ].position[ 0 ];\n\t\t\t\t\tbone.pos[ 1 ] -= data.bones[ bone.parent ].position[ 1 ];\n\t\t\t\t\tbone.pos[ 2 ] -= data.bones[ bone.parent ].position[ 2 ];\n\n\t\t\t\t}\n\n\t\t\t\tbones.push( bone );\n\n\t\t\t}\n\n\t\t\t// iks\n\n\t\t\t// TODO: remove duplicated codes between PMD and PMX\n\t\t\tif ( data.metadata.format === 'pmd' ) {\n\n\t\t\t\tfor ( var i = 0; i < data.metadata.ikCount; i ++ ) {\n\n\t\t\t\t\tvar ik = data.iks[ i ];\n\n\t\t\t\t\tvar param = {\n\t\t\t\t\t\ttarget: ik.target,\n\t\t\t\t\t\teffector: ik.effector,\n\t\t\t\t\t\titeration: ik.iteration,\n\t\t\t\t\t\tmaxAngle: ik.maxAngle * 4,\n\t\t\t\t\t\tlinks: []\n\t\t\t\t\t};\n\n\t\t\t\t\tfor ( var j = 0, jl = ik.links.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar link = {};\n\t\t\t\t\t\tlink.index = ik.links[ j ].index;\n\t\t\t\t\t\tlink.enabled = true;\n\n\t\t\t\t\t\tif ( data.bones[ link.index ].name.indexOf( 'ひざ' ) >= 0 ) {\n\n\t\t\t\t\t\t\tlink.limitation = new Vector3( 1.0, 0.0, 0.0 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparam.links.push( link );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tiks.push( param );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfor ( var i = 0; i < data.metadata.boneCount; i ++ ) {\n\n\t\t\t\t\tvar ik = data.bones[ i ].ik;\n\n\t\t\t\t\tif ( ik === undefined ) continue;\n\n\t\t\t\t\tvar param = {\n\t\t\t\t\t\ttarget: i,\n\t\t\t\t\t\teffector: ik.effector,\n\t\t\t\t\t\titeration: ik.iteration,\n\t\t\t\t\t\tmaxAngle: ik.maxAngle,\n\t\t\t\t\t\tlinks: []\n\t\t\t\t\t};\n\n\t\t\t\t\tfor ( var j = 0, jl = ik.links.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar link = {};\n\t\t\t\t\t\tlink.index = ik.links[ j ].index;\n\t\t\t\t\t\tlink.enabled = true;\n\n\t\t\t\t\t\tif ( ik.links[ j ].angleLimitation === 1 ) {\n\n\t\t\t\t\t\t\t// Revert if rotationMin/Max doesn't work well\n\t\t\t\t\t\t\t// link.limitation = new Vector3( 1.0, 0.0, 0.0 );\n\n\t\t\t\t\t\t\tvar rotationMin = ik.links[ j ].lowerLimitationAngle;\n\t\t\t\t\t\t\tvar rotationMax = ik.links[ j ].upperLimitationAngle;\n\n\t\t\t\t\t\t\t// Convert Left to Right coordinate by myself because\n\t\t\t\t\t\t\t// MMDParser doesn't convert. It's a MMDParser's bug\n\n\t\t\t\t\t\t\tvar tmp1 = - rotationMax[ 0 ];\n\t\t\t\t\t\t\tvar tmp2 = - rotationMax[ 1 ];\n\t\t\t\t\t\t\trotationMax[ 0 ] = - rotationMin[ 0 ];\n\t\t\t\t\t\t\trotationMax[ 1 ] = - rotationMin[ 1 ];\n\t\t\t\t\t\t\trotationMin[ 0 ] = tmp1;\n\t\t\t\t\t\t\trotationMin[ 1 ] = tmp2;\n\n\t\t\t\t\t\t\tlink.rotationMin = new Vector3().fromArray( rotationMin );\n\t\t\t\t\t\t\tlink.rotationMax = new Vector3().fromArray( rotationMax );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparam.links.push( link );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tiks.push( param );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// grants\n\n\t\t\tif ( data.metadata.format === 'pmx' ) {\n\n\t\t\t\tfor ( var i = 0; i < data.metadata.boneCount; i ++ ) {\n\n\t\t\t\t\tvar boneData = data.bones[ i ];\n\t\t\t\t\tvar grant = boneData.grant;\n\n\t\t\t\t\tif ( grant === undefined ) continue;\n\n\t\t\t\t\tvar param = {\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tparentIndex: grant.parentIndex,\n\t\t\t\t\t\tratio: grant.ratio,\n\t\t\t\t\t\tisLocal: grant.isLocal,\n\t\t\t\t\t\taffectRotation: grant.affectRotation,\n\t\t\t\t\t\taffectPosition: grant.affectPosition,\n\t\t\t\t\t\ttransformationClass: boneData.transformationClass\n\t\t\t\t\t};\n\n\t\t\t\t\tgrants.push( param );\n\n\t\t\t\t}\n\n\t\t\t\tgrants.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a.transformationClass - b.transformationClass;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\t// morph\n\n\t\t\tfunction updateAttributes( attribute, morph, ratio ) {\n\n\t\t\t\tfor ( var i = 0; i < morph.elementCount; i ++ ) {\n\n\t\t\t\t\tvar element = morph.elements[ i ];\n\n\t\t\t\t\tvar index;\n\n\t\t\t\t\tif ( data.metadata.format === 'pmd' ) {\n\n\t\t\t\t\t\tindex = data.morphs[ 0 ].elements[ element.index ].index;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tindex = element.index;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tattribute.array[ index * 3 + 0 ] += element.position[ 0 ] * ratio;\n\t\t\t\t\tattribute.array[ index * 3 + 1 ] += element.position[ 1 ] * ratio;\n\t\t\t\t\tattribute.array[ index * 3 + 2 ] += element.position[ 2 ] * ratio;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < data.metadata.morphCount; i ++ ) {\n\n\t\t\t\tvar morph = data.morphs[ i ];\n\t\t\t\tvar params = { name: morph.name };\n\n\t\t\t\tvar attribute = new Float32BufferAttribute( data.metadata.vertexCount * 3, 3 );\n\t\t\t\tattribute.name = morph.name;\n\n\t\t\t\tfor ( var j = 0; j < data.metadata.vertexCount * 3; j ++ ) {\n\n\t\t\t\t\tattribute.array[ j ] = positions[ j ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.metadata.format === 'pmd' ) {\n\n\t\t\t\t\tif ( i !== 0 ) {\n\n\t\t\t\t\t\tupdateAttributes( attribute, morph, 1.0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( morph.type === 0 ) { // group\n\n\t\t\t\t\t\tfor ( var j = 0; j < morph.elementCount; j ++ ) {\n\n\t\t\t\t\t\t\tvar morph2 = data.morphs[ morph.elements[ j ].index ];\n\t\t\t\t\t\t\tvar ratio = morph.elements[ j ].ratio;\n\n\t\t\t\t\t\t\tif ( morph2.type === 1 ) {\n\n\t\t\t\t\t\t\t\tupdateAttributes( attribute, morph2, ratio );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// TODO: implement\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( morph.type === 1 ) { // vertex\n\n\t\t\t\t\t\tupdateAttributes( attribute, morph, 1.0 );\n\n\t\t\t\t\t} else if ( morph.type === 2 ) { // bone\n\n\t\t\t\t\t\t// TODO: implement\n\n\t\t\t\t\t} else if ( morph.type === 3 ) { // uv\n\n\t\t\t\t\t\t// TODO: implement\n\n\t\t\t\t\t} else if ( morph.type === 4 ) { // additional uv1\n\n\t\t\t\t\t\t// TODO: implement\n\n\t\t\t\t\t} else if ( morph.type === 5 ) { // additional uv2\n\n\t\t\t\t\t\t// TODO: implement\n\n\t\t\t\t\t} else if ( morph.type === 6 ) { // additional uv3\n\n\t\t\t\t\t\t// TODO: implement\n\n\t\t\t\t\t} else if ( morph.type === 7 ) { // additional uv4\n\n\t\t\t\t\t\t// TODO: implement\n\n\t\t\t\t\t} else if ( morph.type === 8 ) { // material\n\n                        // TODO: implement\n                        console.log('material=' + morph.name);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tmorphTargets.push( params );\n\t\t\t\tmorphPositions.push( attribute );\n\n\t\t\t}\n\n\t\t\t// rigid bodies from rigidBodies field.\n\n\t\t\tfor ( var i = 0; i < data.metadata.rigidBodyCount; i ++ ) {\n\n\t\t\t\tvar rigidBody = data.rigidBodies[ i ];\n\t\t\t\tvar params = {};\n\n\t\t\t\tfor ( var key in rigidBody ) {\n\n\t\t\t\t\tparams[ key ] = rigidBody[ key ];\n\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t * RigidBody position parameter in PMX seems global position\n\t\t\t\t * while the one in PMD seems offset from corresponding bone.\n\t\t\t\t * So unify being offset.\n\t\t\t\t */\n\t\t\t\tif ( data.metadata.format === 'pmx' ) {\n\n\t\t\t\t\tif ( params.boneIndex !== - 1 ) {\n\n\t\t\t\t\t\tvar bone = data.bones[ params.boneIndex ];\n\t\t\t\t\t\tparams.position[ 0 ] -= bone.position[ 0 ];\n\t\t\t\t\t\tparams.position[ 1 ] -= bone.position[ 1 ];\n\t\t\t\t\t\tparams.position[ 2 ] -= bone.position[ 2 ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\trigidBodies.push( params );\n\n\t\t\t}\n\n\t\t\t// constraints from constraints field.\n\n\t\t\tfor ( var i = 0; i < data.metadata.constraintCount; i ++ ) {\n\n\t\t\t\tvar constraint = data.constraints[ i ];\n\t\t\t\tvar params = {};\n\n\t\t\t\tfor ( var key in constraint ) {\n\n\t\t\t\t\tparams[ key ] = constraint[ key ];\n\n\t\t\t\t}\n\n\t\t\t\tvar bodyA = rigidBodies[ params.rigidBodyIndex1 ];\n\t\t\t\tvar bodyB = rigidBodies[ params.rigidBodyIndex2 ];\n\n\t\t\t\t// Refer to http://www20.atpages.jp/katwat/wp/?p=4135\n\t\t\t\tif ( bodyA.type !== 0 && bodyB.type === 2 ) {\n\n\t\t\t\t\tif ( bodyA.boneIndex !== - 1 && bodyB.boneIndex !== - 1 &&\n\t\t\t\t\t     data.bones[ bodyB.boneIndex ].parentIndex === bodyA.boneIndex ) {\n\n\t\t\t\t\t\tbodyB.type = 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tconstraints.push( params );\n\n\t\t\t}\n\n\t\t\t// build BufferGeometry.\n\n\t\t\tvar geometry = new BufferGeometry();\n\n\t\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\t\t\tgeometry.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\t\tgeometry.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\t\t\tgeometry.setAttribute( 'skinIndex', new Uint16BufferAttribute( skinIndices, 4 ) );\n\t\t\tgeometry.setAttribute( 'skinWeight', new Float32BufferAttribute( skinWeights, 4 ) );\n\t\t\tgeometry.setIndex( indices );\n\n\t\t\tfor ( var i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgeometry.addGroup( groups[ i ].offset, groups[ i ].count, i );\n\n\t\t\t}\n\n\t\t\tgeometry.bones = bones;\n\t\t\tgeometry.morphTargets = morphTargets;\n\t\t\tgeometry.morphAttributes.position = morphPositions;\n            geometry.morphTargetsRelative = false;\n            // console.log(data);\n\n\t\t\tgeometry.userData.MMD = {\n\t\t\t\tbones: bones,\n\t\t\t\tiks: iks,\n\t\t\t\tgrants: grants,\n\t\t\t\trigidBodies: rigidBodies,\n\t\t\t\tconstraints: constraints,\n                format: data.metadata.format,\n                // ↓独自追加\n                morphs: data.morphs,\n                frames: data.frames,\n                modelName: data.metadata.modelName,\n                englishModelName: data.metadata.englishModelName,\n                comment: data.metadata.comment,\n                englishComment: data.metadata.englishComment,\n\t\t\t};\n\n\t\t\tgeometry.computeBoundingSphere();\n\n\t\t\treturn geometry;\n\n\t\t}\n\n\t};\n\n\t//\n\n\t/**\n\t * @param {THREE.LoadingManager} manager\n\t */\n\tfunction MaterialBuilder( manager ) {\n\n\t\tthis.manager = manager;\n\n\t\tthis.textureLoader = new TextureLoader( this.manager );\n\t\tthis.tgaLoader = null; // lazy generation\n\n\t}\n\n\tMaterialBuilder.prototype = {\n\n\t\tconstructor: MaterialBuilder,\n\n\t\tcrossOrigin: 'anonymous',\n\n\t\tresourcePath: undefined,\n\n\t\tresourceDir: undefined,\n\n\t\t/**\n\t\t * @param {string} crossOrigin\n\t\t * @return {MaterialBuilder}\n\t\t */\n\t\tsetCrossOrigin: function ( crossOrigin ) {\n\n\t\t\tthis.crossOrigin = crossOrigin;\n\t\t\treturn this;\n\n\t\t},\n\n\t\t/**\n\t\t * @param {string} resourcePath\n\t\t * @return {MaterialBuilder}\n\t\t */\n\t\tsetResourcePath: function ( resourcePath ) {\n\n\t\t\tthis.resourcePath = resourcePath;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetResourceDir: function ( resourceDir ) {\n\t\t\tthis.resourceDir = resourceDir;\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * @param {Object} data - parsed PMD/PMX data\n\t\t * @param {BufferGeometry} geometry - some properties are dependend on geometry\n\t\t * @param {function} onProgress\n\t\t * @param {function} onError\n\t\t * @return {Array<MeshToonMaterial>}\n\t\t */\n\t\tbuild: function ( data, geometry /*, onProgress, onError */ ) {\n\n\t\t\tvar materials = [];\n\n\t\t\tvar textures = {};\n\n\t\t\tthis.textureLoader.setCrossOrigin( this.crossOrigin );\n\n\t\t\t// materials\n\n\t\t\tfor ( var i = 0; i < data.metadata.materialCount; i ++ ) {\n\n\t\t\t\tvar material = data.materials[ i ];\n\n\t\t\t\tvar params = { userData: {} };\n\n\t\t\t\tif ( material.name !== undefined ) params.name = material.name;\n\n\t\t\t\t/*\n\t\t\t\t * Color\n\t\t\t\t *\n\t\t\t\t * MMD         MeshToonMaterial\n\t\t\t\t * diffuse  -  color\n\t\t\t\t * ambient  -  emissive * a\n\t\t\t\t *               (a = 1.0 without map texture or 0.2 with map texture)\n\t\t\t\t *\n\t\t\t\t * MeshToonMaterial doesn't have ambient. Set it to emissive instead.\n\t\t\t\t * It'll be too bright if material has map texture so using coef 0.2.\n\t\t\t\t */\n\t\t\t\tparams.color = new Color().fromArray( material.diffuse );\n\t\t\t\tparams.opacity = material.diffuse[ 3 ];\n\t\t\t\tparams.emissive = new Color().fromArray( material.ambient );\n\t\t\t\tparams.transparent = params.opacity !== 1.0;\n\n\t\t\t\t//\n\n\t\t\t\tparams.skinning = geometry.bones.length > 0 ? true : false;\n\t\t\t\tparams.morphTargets = geometry.morphTargets.length > 0 ? true : false;\n\t\t\t\tparams.fog = true;\n\n\t\t\t\t// blend\n\n\t\t\t\tparams.blending = CustomBlending;\n\t\t\t\tparams.blendSrc = SrcAlphaFactor;\n\t\t\t\tparams.blendDst = OneMinusSrcAlphaFactor;\n\t\t\t\tparams.blendSrcAlpha = SrcAlphaFactor;\n\t\t\t\tparams.blendDstAlpha = DstAlphaFactor;\n\n\t\t\t\t// side\n\n\t\t\t\tif ( data.metadata.format === 'pmx' && ( material.flag & 0x1 ) === 1 ) {\n\n\t\t\t\t\tparams.side = DoubleSide;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tparams.side = params.opacity === 1.0 ? FrontSide : DoubleSide;\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.metadata.format === 'pmd' ) {\n\n\t\t\t\t\t// map, envMap\n\n\t\t\t\t\tif ( material.fileName ) {\n\n\t\t\t\t\t\tvar fileName = material.fileName;\n\t\t\t\t\t\tvar fileNames = fileName.split( '*' );\n\n\t\t\t\t\t\t// fileNames[ 0 ]: mapFileName\n\t\t\t\t\t\t// fileNames[ 1 ]: envMapFileName( optional )\n\n\t\t\t\t\t\tparams.map = this._loadTexture( fileNames[ 0 ], textures );\n\n\t\t\t\t\t\tif ( fileNames.length > 1 ) {\n\n\t\t\t\t\t\t\tvar extension = fileNames[ 1 ].slice( - 4 ).toLowerCase();\n\n\t\t\t\t\t\t\tparams.envMap = this._loadTexture(\n\t\t\t\t\t\t\t\tfileNames[ 1 ],\n\t\t\t\t\t\t\t\ttextures\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tparams.combine = extension === '.sph'\n\t\t\t\t\t\t\t\t? MultiplyOperation\n\t\t\t\t\t\t\t\t: AddOperation;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// gradientMap\n\n\t\t\t\t\tvar toonFileName = ( material.toonIndex === - 1 )\n\t\t\t\t\t\t? 'toon00.bmp'\n\t\t\t\t\t\t: data.toonTextures[ material.toonIndex ].fileName;\n\n\t\t\t\t\tparams.gradientMap = this._loadTexture(\n\t\t\t\t\t\ttoonFileName,\n\t\t\t\t\t\ttextures,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tisToonTexture: true,\n\t\t\t\t\t\t\tisDefaultToonTexture: this._isDefaultToonTexture( toonFileName )\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t// parameters for OutlineEffect\n\n\t\t\t\t\tparams.userData.outlineParameters = {\n\t\t\t\t\t\tthickness: material.edgeFlag === 1 ? 0.003 : 0.0,\n\t\t\t\t\t\tcolor: [ 0, 0, 0 ],\n\t\t\t\t\t\talpha: 1.0,\n\t\t\t\t\t\tvisible: material.edgeFlag === 1\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// map\n\n\t\t\t\t\tif ( material.textureIndex !== - 1 ) {\n\n\t\t\t\t\t\tparams.map = this._loadTexture( data.textures[ material.textureIndex ], textures );\n\t\t\t\t\t}\n\n\t\t\t\t\t// envMap TODO: support m.envFlag === 3\n\n\t\t\t\t\tif ( material.envTextureIndex !== - 1 && ( material.envFlag === 1 || material.envFlag == 2 ) ) {\n\n\t\t\t\t\t\tparams.envMap = this._loadTexture(\n\t\t\t\t\t\t\tdata.textures[ material.envTextureIndex ],\n\t\t\t\t\t\t\ttextures\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tparams.combine = material.envFlag === 1\n\t\t\t\t\t\t\t? MultiplyOperation\n\t\t\t\t\t\t\t: AddOperation;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// gradientMap\n\n\t\t\t\t\tvar toonFileName, isDefaultToon;\n\n\t\t\t\t\tif ( material.toonIndex === - 1 || material.toonFlag !== 0 ) {\n\n\t\t\t\t\t\ttoonFileName = 'toon' + ( '0' + ( material.toonIndex + 1 ) ).slice( - 2 ) + '.bmp';\n\t\t\t\t\t\tisDefaultToon = true;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttoonFileName = data.textures[ material.toonIndex ];\n\t\t\t\t\t\tisDefaultToon = false;\n\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log('toonFileName=' + toonFileName);\n\t\t\t\t\tconsole.log('----');\n\t\t\t\t\tparams.gradientMap = this._loadTexture(\n\t\t\t\t\t\ttoonFileName,\n\t\t\t\t\t\ttextures,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tisToonTexture: true,\n\t\t\t\t\t\t\tisDefaultToonTexture: isDefaultToon\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t// parameters for OutlineEffect\n\t\t\t\t\tparams.userData.outlineParameters = {\n\t\t\t\t\t\tthickness: material.edgeSize / 300, // TODO: better calculation?\n\t\t\t\t\t\tcolor: material.edgeColor.slice( 0, 3 ),\n\t\t\t\t\t\talpha: material.edgeColor[ 3 ],\n\t\t\t\t\t\tvisible: ( material.flag & 0x10 ) !== 0 && material.edgeSize > 0.0\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tif ( params.map !== undefined ) {\n\n\t\t\t\t\tif ( ! params.transparent ) {\n\t\t\t\t\t\tthis._checkImageTransparency( params.map, geometry, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tparams.emissive.multiplyScalar( 0.2 );\n\n\t\t\t\t}\n\n\t\t\t\tmaterials.push( new MeshToonMaterial( params ) );\n\n\t\t\t}\n\n\t\t\tif ( data.metadata.format === 'pmx' ) {\n\n\t\t\t\t// set transparent true if alpha morph is defined.\n\n\t\t\t\tfunction checkAlphaMorph( elements, materials ) {\n\n\t\t\t\t\tfor ( var i = 0, il = elements.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar element = elements[ i ];\n\n\t\t\t\t\t\tif ( element.index === - 1 ) continue;\n\n\t\t\t\t\t\tvar material = materials[ element.index ];\n\n\t\t\t\t\t\tif ( material.opacity !== element.diffuse[ 3 ] ) {\n\n\t\t\t\t\t\t\tmaterial.transparent = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = 0, il = data.morphs.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar morph = data.morphs[ i ];\n\t\t\t\t\tvar elements = morph.elements;\n\n\t\t\t\t\tif ( morph.type === 0 ) {\n\n\t\t\t\t\t\tfor ( var j = 0, jl = elements.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tvar morph2 = data.morphs[ elements[ j ].index ];\n\n\t\t\t\t\t\t\tif ( morph2.type !== 8 ) continue;\n\n\t\t\t\t\t\t\tcheckAlphaMorph( morph2.elements, materials );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( morph.type === 8 ) {\n\n\t\t\t\t\t\tcheckAlphaMorph( elements, materials );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn materials;\n\n\t\t},\n\n\t\t// private methods\n\n\t\t_getTGALoader: function () {\n\n\t\t\tif ( this.tgaLoader === null ) {\n\n\t\t\t\tif ( TGALoader === undefined ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.MMDLoader: Import TGALoader' );\n\n\t\t\t\t}\n\n\t\t\t\tthis.tgaLoader = new TGALoader( this.manager );\n\n\t\t\t}\n\n\t\t\treturn this.tgaLoader;\n\n\t\t},\n\n\t\t_isDefaultToonTexture: function ( name ) {\n\n\t\t\tif ( name.length !== 10 ) return false;\n\n\t\t\treturn /toon(10|0[0-9])\\.bmp/.test( name );\n\n\t\t},\n\n\t\t_loadTexture: function ( filePath, textures, params, onProgress, onError ) {\n\t\t\tparams = params || {};\n\n\t\t\tvar scope = this;\n\n\t\t\tvar fullPath;\n\n\t\t\tif ( params.isDefaultToonTexture === true ) {\n\n\t\t\t\tvar index;\n\n\t\t\t\ttry {\n\n\t\t\t\t\tindex = parseInt( filePath.match( /toon([0-9]{2})\\.bmp$/ )[ 1 ] );\n\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.MMDLoader: ' + filePath + ' seems like a '\n\t\t\t\t\t\t+ 'not right default texture path. Using toon00.bmp instead.' );\n\n\t\t\t\t\tindex = 0;\n\n\t\t\t\t}\n\n\t\t\t\tfullPath = DEFAULT_TOON_TEXTURES[ index ];\n\n\t\t\t} else {\n\n\t\t\t\t// fullPath = this.resourcePath + filePath;\n\t\t\t\tfullPath = this.resourceDir[filePath];\n\t\t\t}\n\t\t\tif ( textures[ fullPath ] !== undefined ) return textures[ fullPath ];\n\n\t\t\tvar loader = this.manager.getHandler( fullPath );\n\t\t\tif ( loader === null ) {\n\t\t\t\tloader = ( filePath.slice( - 4 ).toLowerCase() === '.tga' )\n\t\t\t\t\t? this._getTGALoader()\n\t\t\t\t\t: this.textureLoader;\n\n\t\t\t}\n\n\t\t\tvar texture = loader.load( fullPath, function ( t ) {\n\n\t\t\t\t// MMD toon texture is Axis-Y oriented\n\t\t\t\t// but Three.js gradient map is Axis-X oriented.\n\t\t\t\t// So here replaces the toon texture image with the rotated one.\n\t\t\t\tif ( params.isToonTexture === true ) {\n\n\t\t\t\t\tt.image = scope._getRotatedImage( t.image );\n\n\t\t\t\t\tt.magFilter = NearestFilter;\n\t\t\t\t\tt.minFilter = NearestFilter;\n\n\t\t\t\t}\n\n\t\t\t\tt.flipY = false;\n\t\t\t\tt.wrapS = RepeatWrapping;\n\t\t\t\tt.wrapT = RepeatWrapping;\n\n\t\t\t\tfor ( var i = 0; i < texture.readyCallbacks.length; i ++ ) {\n\n\t\t\t\t\ttexture.readyCallbacks[ i ]( texture );\n\n\t\t\t\t}\n\n\t\t\t\tdelete texture.readyCallbacks;\n\n\t\t\t}, onProgress, onError );\n\n\t\t\ttexture.readyCallbacks = [];\n\n\t\t\ttextures[ fullPath ] = texture;\n\t\t\treturn texture;\n\n\t\t},\n\n\t\t_getRotatedImage: function ( image ) {\n\n\t\t\tvar canvas = document.createElement( 'canvas' );\n\t\t\tvar context = canvas.getContext( '2d' );\n\n\t\t\tvar width = image.width;\n\t\t\tvar height = image.height;\n\n\t\t\tcanvas.width = width;\n\t\t\tcanvas.height = height;\n\n\t\t\tcontext.clearRect( 0, 0, width, height );\n\t\t\tcontext.translate( width / 2.0, height / 2.0 );\n\t\t\tcontext.rotate( 0.5 * Math.PI ); // 90.0 * Math.PI / 180.0\n\t\t\tcontext.translate( - width / 2.0, - height / 2.0 );\n\t\t\tcontext.drawImage( image, 0, 0 );\n\n\t\t\treturn context.getImageData( 0, 0, width, height );\n\n\t\t},\n\n\t\t// Check if the partial image area used by the texture is transparent.\n\t\t_checkImageTransparency: async function ( map, geometry, groupIndex ) {\n\t\t\tmap.readyCallbacks.push( function ( texture ) {\n\n\t\t\t\t// Is there any efficient ways?\n\t\t\t\tfunction createImageData( image ) {\n\n\t\t\t\t\tvar canvas = document.createElement( 'canvas' );\n\t\t\t\t\tcanvas.width = image.width;\n\t\t\t\t\tcanvas.height = image.height;\n\n\t\t\t\t\tvar context = canvas.getContext( '2d' );\n\t\t\t\t\tcontext.drawImage( image, 0, 0 );\n\n\t\t\t\t\treturn context.getImageData( 0, 0, canvas.width, canvas.height );\n\n\t\t\t\t}\n\n\t\t\t\tfunction detectImageTransparency( image, uvs, indices ) {\n\n\t\t\t\t\tvar width = image.width;\n\t\t\t\t\tvar height = image.height;\n\t\t\t\t\tvar data = image.data;\n\t\t\t\t\tvar threshold = 253;\n\n\t\t\t\t\tif ( data.length / ( width * height ) !== 4 ) return false;\n\n\t\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\n\n\t\t\t\t\t\tvar centerUV = { x: 0.0, y: 0.0 };\n\n\t\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t\tvar index = indices[ i * 3 + j ];\n\t\t\t\t\t\t\tvar uv = { x: uvs[ index * 2 + 0 ], y: uvs[ index * 2 + 1 ] };\n\n\t\t\t\t\t\t\tif ( getAlphaByUv( image, uv ) < threshold ) return true;\n\n\t\t\t\t\t\t\tcenterUV.x += uv.x;\n\t\t\t\t\t\t\tcenterUV.y += uv.y;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcenterUV.x /= 3;\n\t\t\t\t\t\tcenterUV.y /= 3;\n\n\t\t\t\t\t\tif ( getAlphaByUv( image, centerUV ) < threshold ) return true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t * This method expects\n\t\t\t\t *   texture.flipY = false\n\t\t\t\t *   texture.wrapS = RepeatWrapping\n\t\t\t\t *   texture.wrapT = RepeatWrapping\n\t\t\t\t * TODO: more precise\n\t\t\t\t */\n\t\t\t\tfunction getAlphaByUv( image, uv ) {\n\n\t\t\t\t\tvar width = image.width;\n\t\t\t\t\tvar height = image.height;\n\n\t\t\t\t\tvar x = Math.round( uv.x * width ) % width;\n\t\t\t\t\tvar y = Math.round( uv.y * height ) % height;\n\n\t\t\t\t\tif ( x < 0 ) x += width;\n\t\t\t\t\tif ( y < 0 ) y += height;\n\n\t\t\t\t\tvar index = y * width + x;\n\n\t\t\t\t\treturn image.data[ index * 4 + 3 ];\n\n\t\t\t\t}\n\n\t\t\t\tvar imageData = texture.image.data !== undefined\n\t\t\t\t\t? texture.image\n\t\t\t\t\t: createImageData( texture.image );\n\n\t\t\t\tvar group = geometry.groups[ groupIndex ];\n\n\t\t\t\tif ( detectImageTransparency(\n\t\t\t\t\timageData,\n\t\t\t\t\tgeometry.attributes.uv.array,\n\t\t\t\t\tgeometry.index.array.slice( group.start, group.start + group.count ) ) ) {\n\n\t\t\t\t\tmap.transparent = true;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t};\n\n\t//\n\n\tfunction AnimationBuilder() {\n\n\t}\n\n\tAnimationBuilder.prototype = {\n\n\t\tconstructor: AnimationBuilder,\n\n\t\t/**\n\t\t * @param {Object} vmd - parsed VMD data\n\t\t * @param {SkinnedMesh} mesh - tracks will be fitting to mesh\n\t\t * @return {AnimationClip}\n\t\t */\n\t\tbuild: function ( vmd, mesh ) {\n\n\t\t\t// combine skeletal and morph animations\n\n\t\t\tvar tracks = this.buildSkeletalAnimation( vmd, mesh ).tracks;\n\t\t\tvar tracks2 = this.buildMorphAnimation( vmd, mesh ).tracks;\n\n\t\t\tfor ( var i = 0, il = tracks2.length; i < il; i ++ ) {\n\n\t\t\t\ttracks.push( tracks2[ i ] );\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( '', - 1, tracks );\n\n\t\t},\n\n\t\t/**\n\t\t * @param {Object} vmd - parsed VMD data\n\t\t * @param {SkinnedMesh} mesh - tracks will be fitting to mesh\n\t\t * @return {AnimationClip}\n\t\t */\n\t\tbuildSkeletalAnimation: function ( vmd, mesh ) {\n\n\t\t\tfunction pushInterpolation( array, interpolation, index ) {\n\n\t\t\t\tarray.push( interpolation[ index + 0 ] / 127 ); // x1\n\t\t\t\tarray.push( interpolation[ index + 8 ] / 127 ); // x2\n\t\t\t\tarray.push( interpolation[ index + 4 ] / 127 ); // y1\n\t\t\t\tarray.push( interpolation[ index + 12 ] / 127 ); // y2\n\n\t\t\t}\n\n\t\t\tvar tracks = [];\n\n\t\t\tvar motions = {};\n\t\t\tvar bones = mesh.skeleton.bones;\n\t\t\tvar boneNameDictionary = {};\n\n\t\t\tfor ( var i = 0, il = bones.length; i < il; i ++ ) {\n\n\t\t\t\tboneNameDictionary[ bones[ i ].name ] = true;\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < vmd.metadata.motionCount; i ++ ) {\n\n\t\t\t\tvar motion = vmd.motions[ i ];\n\t\t\t\tvar boneName = motion.boneName;\n\n\t\t\t\tif ( boneNameDictionary[ boneName ] === undefined ) continue;\n\n\t\t\t\tmotions[ boneName ] = motions[ boneName ] || [];\n\t\t\t\tmotions[ boneName ].push( motion );\n\n\t\t\t}\n\n\t\t\tfor ( var key in motions ) {\n\n\t\t\t\tvar array = motions[ key ];\n\n\t\t\t\tarray.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a.frameNum - b.frameNum;\n\n\t\t\t\t} );\n\n\t\t\t\tvar times = [];\n\t\t\t\tvar positions = [];\n\t\t\t\tvar rotations = [];\n\t\t\t\tvar pInterpolations = [];\n\t\t\t\tvar rInterpolations = [];\n\n\t\t\t\tvar basePosition = mesh.skeleton.getBoneByName( key ).position.toArray();\n\n\t\t\t\tfor ( var i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar time = array[ i ].frameNum / 30;\n\t\t\t\t\tvar position = array[ i ].position;\n\t\t\t\t\tvar rotation = array[ i ].rotation;\n\t\t\t\t\tvar interpolation = array[ i ].interpolation;\n\n\t\t\t\t\ttimes.push( time );\n\n\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) positions.push( basePosition[ j ] + position[ j ] );\n\t\t\t\t\tfor ( var j = 0; j < 4; j ++ ) rotations.push( rotation[ j ] );\n\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) pushInterpolation( pInterpolations, interpolation, j );\n\n\t\t\t\t\tpushInterpolation( rInterpolations, interpolation, 3 );\n\n\t\t\t\t}\n\n\t\t\t\tvar targetName = '.bones[' + key + ']';\n\n\t\t\t\ttracks.push( this._createTrack( targetName + '.position', VectorKeyframeTrack, times, positions, pInterpolations ) );\n\t\t\t\ttracks.push( this._createTrack( targetName + '.quaternion', QuaternionKeyframeTrack, times, rotations, rInterpolations ) );\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( '', - 1, tracks );\n\n\t\t},\n\n\t\t/**\n\t\t * @param {Object} vmd - parsed VMD data\n\t\t * @param {SkinnedMesh} mesh - tracks will be fitting to mesh\n\t\t * @return {AnimationClip}\n\t\t */\n\t\tbuildMorphAnimation: function ( vmd, mesh ) {\n\n\t\t\tvar tracks = [];\n\n\t\t\tvar morphs = {};\n\t\t\tvar morphTargetDictionary = mesh.morphTargetDictionary;\n\n\t\t\tfor ( var i = 0; i < vmd.metadata.morphCount; i ++ ) {\n\n\t\t\t\tvar morph = vmd.morphs[ i ];\n\t\t\t\tvar morphName = morph.morphName;\n\n\t\t\t\tif ( morphTargetDictionary[ morphName ] === undefined ) continue;\n\n\t\t\t\tmorphs[ morphName ] = morphs[ morphName ] || [];\n\t\t\t\tmorphs[ morphName ].push( morph );\n\n\t\t\t}\n\n\t\t\tfor ( var key in morphs ) {\n\n\t\t\t\tvar array = morphs[ key ];\n\n\t\t\t\tarray.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a.frameNum - b.frameNum;\n\n\t\t\t\t} );\n\n\t\t\t\tvar times = [];\n\t\t\t\tvar values = [];\n\n\t\t\t\tfor ( var i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t\t\ttimes.push( array[ i ].frameNum / 30 );\n\t\t\t\t\tvalues.push( array[ i ].weight );\n\n\t\t\t\t}\n\n\t\t\t\ttracks.push( new NumberKeyframeTrack( '.morphTargetInfluences[' + morphTargetDictionary[ key ] + ']', times, values ) );\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( '', - 1, tracks );\n\n\t\t},\n\n\t\t/**\n\t\t * @param {Object} vmd - parsed VMD data\n\t\t * @return {AnimationClip}\n\t\t */\n\t\tbuildCameraAnimation: function ( vmd ) {\n\n\t\t\tfunction pushVector3( array, vec ) {\n\n\t\t\t\tarray.push( vec.x );\n\t\t\t\tarray.push( vec.y );\n\t\t\t\tarray.push( vec.z );\n\n\t\t\t}\n\n\t\t\tfunction pushQuaternion( array, q ) {\n\n\t\t\t\tarray.push( q.x );\n\t\t\t\tarray.push( q.y );\n\t\t\t\tarray.push( q.z );\n\t\t\t\tarray.push( q.w );\n\n\t\t\t}\n\n\t\t\tfunction pushInterpolation( array, interpolation, index ) {\n\n\t\t\t\tarray.push( interpolation[ index * 4 + 0 ] / 127 ); // x1\n\t\t\t\tarray.push( interpolation[ index * 4 + 1 ] / 127 ); // x2\n\t\t\t\tarray.push( interpolation[ index * 4 + 2 ] / 127 ); // y1\n\t\t\t\tarray.push( interpolation[ index * 4 + 3 ] / 127 ); // y2\n\n\t\t\t}\n\n\t\t\tvar tracks = [];\n\n\t\t\tvar cameras = vmd.cameras === undefined ? [] : vmd.cameras.slice();\n\n\t\t\tcameras.sort( function ( a, b ) {\n\n\t\t\t\treturn a.frameNum - b.frameNum;\n\n\t\t\t} );\n\n\t\t\tvar times = [];\n\t\t\tvar centers = [];\n\t\t\tvar quaternions = [];\n\t\t\tvar positions = [];\n\t\t\tvar fovs = [];\n\n\t\t\tvar cInterpolations = [];\n\t\t\tvar qInterpolations = [];\n\t\t\tvar pInterpolations = [];\n\t\t\tvar fInterpolations = [];\n\n\t\t\tvar quaternion = new Quaternion();\n\t\t\tvar euler = new Euler();\n\t\t\tvar position = new Vector3();\n\t\t\tvar center = new Vector3();\n\n\t\t\tfor ( var i = 0, il = cameras.length; i < il; i ++ ) {\n\n\t\t\t\tvar motion = cameras[ i ];\n\n\t\t\t\tvar time = motion.frameNum / 30;\n\t\t\t\tvar pos = motion.position;\n\t\t\t\tvar rot = motion.rotation;\n\t\t\t\tvar distance = motion.distance;\n\t\t\t\tvar fov = motion.fov;\n\t\t\t\tvar interpolation = motion.interpolation;\n\n\t\t\t\ttimes.push( time );\n\n\t\t\t\tposition.set( 0, 0, - distance );\n\t\t\t\tcenter.set( pos[ 0 ], pos[ 1 ], pos[ 2 ] );\n\n\t\t\t\teuler.set( - rot[ 0 ], - rot[ 1 ], - rot[ 2 ] );\n\t\t\t\tquaternion.setFromEuler( euler );\n\n\t\t\t\tposition.add( center );\n\t\t\t\tposition.applyQuaternion( quaternion );\n\n\t\t\t\tpushVector3( centers, center );\n\t\t\t\tpushQuaternion( quaternions, quaternion );\n\t\t\t\tpushVector3( positions, position );\n\n\t\t\t\tfovs.push( fov );\n\n\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\tpushInterpolation( cInterpolations, interpolation, j );\n\n\t\t\t\t}\n\n\t\t\t\tpushInterpolation( qInterpolations, interpolation, 3 );\n\n\t\t\t\t// use the same parameter for x, y, z axis.\n\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\tpushInterpolation( pInterpolations, interpolation, 4 );\n\n\t\t\t\t}\n\n\t\t\t\tpushInterpolation( fInterpolations, interpolation, 5 );\n\n\t\t\t}\n\n\t\t\tvar tracks = [];\n\n\t\t\t// I expect an object whose name 'target' exists under THREE.Camera\n\t\t\ttracks.push( this._createTrack( 'target.position', VectorKeyframeTrack, times, centers, cInterpolations ) );\n\n\t\t\ttracks.push( this._createTrack( '.quaternion', QuaternionKeyframeTrack, times, quaternions, qInterpolations ) );\n\t\t\ttracks.push( this._createTrack( '.position', VectorKeyframeTrack, times, positions, pInterpolations ) );\n\t\t\ttracks.push( this._createTrack( '.fov', NumberKeyframeTrack, times, fovs, fInterpolations ) );\n\n\t\t\treturn new AnimationClip( '', - 1, tracks );\n\n\t\t},\n\n\t\t// private method\n\n\t\t_createTrack: function ( node, typedKeyframeTrack, times, values, interpolations ) {\n\n\t\t\t/*\n\t\t\t * optimizes here not to let KeyframeTrackPrototype optimize\n\t\t\t * because KeyframeTrackPrototype optimizes times and values but\n\t\t\t * doesn't optimize interpolations.\n\t\t\t */\n\t\t\tif ( times.length > 2 ) {\n\n\t\t\t\ttimes = times.slice();\n\t\t\t\tvalues = values.slice();\n\t\t\t\tinterpolations = interpolations.slice();\n\n\t\t\t\tvar stride = values.length / times.length;\n\t\t\t\tvar interpolateStride = interpolations.length / times.length;\n\n\t\t\t\tvar index = 1;\n\n\t\t\t\tfor ( var aheadIndex = 2, endIndex = times.length; aheadIndex < endIndex; aheadIndex ++ ) {\n\n\t\t\t\t\tfor ( var i = 0; i < stride; i ++ ) {\n\n\t\t\t\t\t\tif ( values[ index * stride + i ] !== values[ ( index - 1 ) * stride + i ] ||\n\t\t\t\t\t\t\tvalues[ index * stride + i ] !== values[ aheadIndex * stride + i ] ) {\n\n\t\t\t\t\t\t\tindex ++;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( aheadIndex > index ) {\n\n\t\t\t\t\t\ttimes[ index ] = times[ aheadIndex ];\n\n\t\t\t\t\t\tfor ( var i = 0; i < stride; i ++ ) {\n\n\t\t\t\t\t\t\tvalues[ index * stride + i ] = values[ aheadIndex * stride + i ];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor ( var i = 0; i < interpolateStride; i ++ ) {\n\n\t\t\t\t\t\t\tinterpolations[ index * interpolateStride + i ] = interpolations[ aheadIndex * interpolateStride + i ];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\ttimes.length = index + 1;\n\t\t\t\tvalues.length = ( index + 1 ) * stride;\n\t\t\t\tinterpolations.length = ( index + 1 ) * interpolateStride;\n\n\t\t\t}\n\n\t\t\tvar track = new typedKeyframeTrack( node, times, values );\n\n\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodCubicBezier( result ) {\n\n\t\t\t\treturn new CubicBezierInterpolation( this.times, this.values, this.getValueSize(), result, new Float32Array( interpolations ) );\n\n\t\t\t};\n\n\t\t\treturn track;\n\n\t\t}\n\n\t};\n\n\t// interpolation\n\n\tfunction CubicBezierInterpolation( parameterPositions, sampleValues, sampleSize, resultBuffer, params ) {\n\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t\tthis.interpolationParams = params;\n\n\t}\n\n\tCubicBezierInterpolation.prototype = Object.assign( Object.create( Interpolant.prototype ), {\n\n\t\tconstructor: CubicBezierInterpolation,\n\n\t\tinterpolate_: function ( i1, t0, t, t1 ) {\n\n\t\t\tvar result = this.resultBuffer;\n\t\t\tvar values = this.sampleValues;\n\t\t\tvar stride = this.valueSize;\n\t\t\tvar params = this.interpolationParams;\n\n\t\t\tvar offset1 = i1 * stride;\n\t\t\tvar offset0 = offset1 - stride;\n\n\t\t\t// No interpolation if next key frame is in one frame in 30fps.\n\t\t\t// This is from MMD animation spec.\n\t\t\t// '1.5' is for precision loss. times are Float32 in Three.js Animation system.\n\t\t\tvar weight1 = ( ( t1 - t0 ) < 1 / 30 * 1.5 ) ? 0.0 : ( t - t0 ) / ( t1 - t0 );\n\n\t\t\tif ( stride === 4 ) { // Quaternion\n\n\t\t\t\tvar x1 = params[ i1 * 4 + 0 ];\n\t\t\t\tvar x2 = params[ i1 * 4 + 1 ];\n\t\t\t\tvar y1 = params[ i1 * 4 + 2 ];\n\t\t\t\tvar y2 = params[ i1 * 4 + 3 ];\n\n\t\t\t\tvar ratio = this._calculate( x1, x2, y1, y2, weight1 );\n\n\t\t\t\tQuaternion.slerpFlat( result, 0, values, offset0, values, offset1, ratio );\n\n\t\t\t} else if ( stride === 3 ) { // Vector3\n\n\t\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\n\n\t\t\t\t\tvar x1 = params[ i1 * 12 + i * 4 + 0 ];\n\t\t\t\t\tvar x2 = params[ i1 * 12 + i * 4 + 1 ];\n\t\t\t\t\tvar y1 = params[ i1 * 12 + i * 4 + 2 ];\n\t\t\t\t\tvar y2 = params[ i1 * 12 + i * 4 + 3 ];\n\n\t\t\t\t\tvar ratio = this._calculate( x1, x2, y1, y2, weight1 );\n\n\t\t\t\t\tresult[ i ] = values[ offset0 + i ] * ( 1 - ratio ) + values[ offset1 + i ] * ratio;\n\n\t\t\t\t}\n\n\t\t\t} else { // Number\n\n\t\t\t\tvar x1 = params[ i1 * 4 + 0 ];\n\t\t\t\tvar x2 = params[ i1 * 4 + 1 ];\n\t\t\t\tvar y1 = params[ i1 * 4 + 2 ];\n\t\t\t\tvar y2 = params[ i1 * 4 + 3 ];\n\n\t\t\t\tvar ratio = this._calculate( x1, x2, y1, y2, weight1 );\n\n\t\t\t\tresult[ 0 ] = values[ offset0 ] * ( 1 - ratio ) + values[ offset1 ] * ratio;\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t},\n\n\t\t_calculate: function ( x1, x2, y1, y2, x ) {\n\n\t\t\t/*\n\t\t\t * Cubic Bezier curves\n\t\t\t *   https://en.wikipedia.org/wiki/B%C3%A9zier_curve#Cubic_B.C3.A9zier_curves\n\t\t\t *\n\t\t\t * B(t) = ( 1 - t ) ^ 3 * P0\n\t\t\t *      + 3 * ( 1 - t ) ^ 2 * t * P1\n\t\t\t *      + 3 * ( 1 - t ) * t^2 * P2\n\t\t\t *      + t ^ 3 * P3\n\t\t\t *      ( 0 <= t <= 1 )\n\t\t\t *\n\t\t\t * MMD uses Cubic Bezier curves for bone and camera animation interpolation.\n\t\t\t *   http://d.hatena.ne.jp/edvakf/20111016/1318716097\n\t\t\t *\n\t\t\t *    x = ( 1 - t ) ^ 3 * x0\n\t\t\t *      + 3 * ( 1 - t ) ^ 2 * t * x1\n\t\t\t *      + 3 * ( 1 - t ) * t^2 * x2\n\t\t\t *      + t ^ 3 * x3\n\t\t\t *    y = ( 1 - t ) ^ 3 * y0\n\t\t\t *      + 3 * ( 1 - t ) ^ 2 * t * y1\n\t\t\t *      + 3 * ( 1 - t ) * t^2 * y2\n\t\t\t *      + t ^ 3 * y3\n\t\t\t *      ( x0 = 0, y0 = 0 )\n\t\t\t *      ( x3 = 1, y3 = 1 )\n\t\t\t *      ( 0 <= t, x1, x2, y1, y2 <= 1 )\n\t\t\t *\n\t\t\t * Here solves this equation with Bisection method,\n\t\t\t *   https://en.wikipedia.org/wiki/Bisection_method\n\t\t\t * gets t, and then calculate y.\n\t\t\t *\n\t\t\t * f(t) = 3 * ( 1 - t ) ^ 2 * t * x1\n\t\t\t *      + 3 * ( 1 - t ) * t^2 * x2\n\t\t\t *      + t ^ 3 - x = 0\n\t\t\t *\n\t\t\t * (Another option: Newton's method\n\t\t\t *    https://en.wikipedia.org/wiki/Newton%27s_method)\n\t\t\t */\n\n\t\t\tvar c = 0.5;\n\t\t\tvar t = c;\n\t\t\tvar s = 1.0 - t;\n\t\t\tvar loop = 15;\n\t\t\tvar eps = 1e-5;\n\t\t\tvar math = Math;\n\n\t\t\tvar sst3, stt3, ttt;\n\n\t\t\tfor ( var i = 0; i < loop; i ++ ) {\n\n\t\t\t\tsst3 = 3.0 * s * s * t;\n\t\t\t\tstt3 = 3.0 * s * t * t;\n\t\t\t\tttt = t * t * t;\n\n\t\t\t\tvar ft = ( sst3 * x1 ) + ( stt3 * x2 ) + ( ttt ) - x;\n\n\t\t\t\tif ( math.abs( ft ) < eps ) break;\n\n\t\t\t\tc /= 2.0;\n\n\t\t\t\tt += ( ft < 0 ) ? c : - c;\n\t\t\t\ts = 1.0 - t;\n\n\t\t\t}\n\n\t\t\treturn ( sst3 * y1 ) + ( stt3 * y2 ) + ttt;\n\n\t\t}\n\n\t} );\n\n\treturn MMDLoader;\n\n} )();\n\nexport { MMDLoader };","import React from 'react';\nimport { ModelClass } from '../classes/ModelClass';\nimport { MMDLoader } from '../libs/MMDLoader'\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport { Button, createStyles, makeStyles, Theme } from '@material-ui/core';\nimport { SkinnedMesh } from 'three';\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        formControl: {\n            margin: theme.spacing(1),\n            minWidth: 200,\n        },\n            selectEmpty: {\n            marginTop: theme.spacing(2),\n        },\n    }),\n);\n\nfunction ModelControl(props:any){\n\n    const classes = useStyles();\n\n    function onChangeModelSelect(event: React.ChangeEvent<{ name?: string; value: unknown }>){\n        props.setActiveModelId(event.target.value);\n    }\n\n    async function onLoadModel(){\n        // @ts-ignore\n        const dirHandle = await window.showDirectoryPicker();\n        const loader = new MMDLoader();\n        try {\n            const m:ModelClass = new ModelClass(props.models.length);\n            // @ts-ignore\n            loader.loadFromDir(dirHandle,(mesh: SkinnedMesh) => {\n                m.mesh = mesh;\n                const comment = \"モデル情報:\\n\\n\" + mesh.geometry.userData.MMD.comment;\n                m.comment = comment;\n                m.modelName = props.models.length + ':' + mesh.geometry.userData.MMD.modelName;\n\n                const newModels = [...props.models,m];\n                const newActiveId = props.activeModelId + 1;\n                alert(m.comment);\n                props.setModels(newModels);\n                props.setActiveModelId(newActiveId);\n            });\n        } catch(e) {\n            console.error(e);\n        }\n    }\n\n    function onDeleteModel(){\n        if(props.activeModelId === -1){\n            console.log('これ以上削除はできない')\n            return;\n        }\n        const newModels = props.models.filter((m: ModelClass) => m.id !== props.activeModelId);\n        console.log(newModels);\n        const newActiveId = props.activeModelId - 1;\n        props.setModels(newModels);\n        props.setActiveModelId(newActiveId);\n    }\n    return (\n        <div style={{textAlign: \"center\"}}>\n            <p style={{color:\"black\",fontSize:20,margin:\"5px 0px 0px 0px\"}}>モデル操作</p>\n            <div style={{padding:\"0px 10px 10px 10px\"}}>\n                <FormControl variant=\"filled\" className={classes.formControl}>\n                    <div>\n                        <Select\n                        style={{width:\"100%\"}}\n                        onChange={onChangeModelSelect}\n                        native>\n                            {props.models.map((model: ModelClass,index: number) => {\n                                return(\n                                <option key={model.id} value={model.id}>{model.modelName}</option>\n                            )})}\n                        </Select>\n                    </div>\n                    <div>\n                        <Button variant=\"contained\" style={{width:\"50%\"}} onClick={onLoadModel}>読み込み</Button>\n                        <Button variant=\"contained\" style={{width:\"50%\"}} onClick={onDeleteModel}>削除</Button>\n                    </div>\n                </FormControl>\n            </div>\n        </div>\n      );\n}\nexport default ModelControl;","\nimport React, { useRef, useEffect, useState }  from 'react';\nimport { useThree } from 'react-three-fiber';\nimport { TransformControls, OrbitControls } from '@react-three/drei';\nimport { CCDIKHelper, CCDIKSolver } from 'three/examples/jsm/animation/CCDIKSolver';\n\nfunction ModelView(props: any) {\n    const mesh = useRef<THREE.Mesh>()\n    const orbit = useRef<OrbitControls>()\n    const transform = useRef<TransformControls>()\n    const { scene } = useThree()\n    const [ ikHepler, setIkHelper ] = useState<CCDIKHelper|null>(null);\n    useEffect(() => {\n        if (typeof transform.current !== 'undefined') {\n            const controls: any = transform.current\n            const callback = (event: any) => {\n                if(orbit.current){\n                    orbit.current.enabled = !event.value\n                }\n            }\n            if(controls) {\n                if(props.activeModelId === props.modelClass.id) {\n                    controls.attach(props.modelClass.mesh.skeleton.bones[props.selectObject]);\n                    if(props.controlMode === 'select'){\n                        if(props.modelClass.mesh) {\n                            if(ikHepler == null) {\n                                var solver = new CCDIKSolver(props.modelClass.mesh,props.modelClass.mesh.geometry.userData.MMD.iks);\n                                const helper = solver.createHelper();\n                                setIkHelper(helper);\n                                // @ts-ignore\n                                scene.add(helper);\n                            } else {\n                                // @ts-ignore\n                                ikHepler.visible = true;\n                                controls.detach();\n                            }\n                        }\n                    }else{\n                        controls.setMode(props.controlMode);\n                        if(ikHepler !== null) {\n                            // @ts-ignore\n                            ikHepler.visible = false;\n                        }\n                    }\n                    controls.addEventListener(\"dragging-changed\", callback)\n                    return () => controls.removeEventListener(\"dragging-changed\", callback)\n                }\n            }\n        }\n    }, [props.activeModelId, props.modelClass.id, props.modelClass.mesh, props.selectObject, props.controlMode, ikHepler, scene])\n\n    return (\n        <>\n            <TransformControls ref={transform}>\n                <mesh ref={mesh}>\n                    <primitive \n                        object={props.modelClass.mesh} dispose={null} scale={[0.25 ,0.25, 0.25]} position={props.position} />\n                </mesh>\n            </TransformControls>\n            <OrbitControls ref={orbit}/>\n        </>\n    );\n}\n\nexport default ModelView;\n","import React, { useEffect, useState, useRef, CSSProperties } from 'react';\nfunction BoneControl(props:any){\n    function setControl(mode:string) {\n        props.setControlMode(mode);\n    }\n    return (\n        <div style={{textAlign: \"center\"}}>\n            <p style={{color:\"black\",fontSize:20,margin:\"5px 0px 0px 0px\"}}>ボーン操作</p>\n            <div style={{padding:\"5px 10px 10px 10px\"}}>\n                <input style={{width:\"30%\"}} type=\"button\" value=\"選択\" onClick={() => setControl('select')}/>\n                <input style={{width:\"30%\"}} type=\"button\" value=\"回転\" onClick={() => setControl('rotate')}/>\n                <input style={{width:\"30%\"}} type=\"button\" value=\"移動\" onClick={() => setControl('translate')}/>\n            </div>\n        </div>\n      );\n}\nexport default BoneControl;","import React, { Suspense, useState } from 'react';\nimport * as p from '../package.json';\nimport './App.css';\nimport { AppBar, createStyles, Grid, IconButton, makeStyles, Menu, MenuItem, Theme, Toolbar, Typography } from '@material-ui/core';\nimport InfoIcon from '@material-ui/icons/Info';\nimport { Canvas } from 'react-three-fiber';\nimport ModelControl from './components/ModelControl';\nimport ModelView from './components/ModelView';\nimport BoneControl from './components/BoneControl';\nimport { ModelClass } from './classes/ModelClass';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      flexGrow: 1,\n    },\n    menuButton: {\n      marginRight: theme.spacing(2),\n    },\n    title: {\n      flexGrow: 1,\n    },\n  }),\n);\n\nfunction App() {\n    const [models, setModels] = useState<ModelClass[]>([]);\n    const [selectObject, setSelectObject] = useState(0);\n    const [activeModelId, setActiveModelId] = useState(-1);\n    const [controlMode, setControlMode] = useState('rotate');\n\n    const classes = useStyles();\n    const [openLicense, setOpenLicense] = React.useState(false);\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n    const open = Boolean(anchorEl);\n    \n    const handleMenu = (event: React.MouseEvent<HTMLElement>) => {\n        setAnchorEl(event.currentTarget);\n    };\n    \n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    return (\n        <>\n            <AppBar position=\"static\">\n                <Toolbar>\n                    <Typography variant=\"h6\" color=\"inherit\" className={classes.title}>\n                        React MMD Viewer ver.{p.version}\n                    </Typography>\n                    <IconButton\n                        aria-label=\"account of current user\"\n                        aria-controls=\"menu-appbar\"\n                        aria-haspopup=\"true\"\n                        onClick={handleMenu}\n                        color=\"inherit\"\n                    >\n                        <InfoIcon />\n                    </IconButton>\n                    <Menu\n                        id=\"menu-appbar\"\n                        anchorEl={anchorEl}\n                        anchorOrigin={{\n                            vertical: 'top',\n                            horizontal: 'right',\n                        }}\n                        keepMounted\n                        transformOrigin={{\n                            vertical: 'top',\n                            horizontal: 'right',\n                        }}\n                        open={open}\n                        onClose={handleClose}\n                    >\n                        <MenuItem onClick={() => window.open(\"https://github.com/\" + p.author.name + \"/\" + p.name)}>Github</MenuItem>\n                    </Menu>\n                </Toolbar>\n            </AppBar>\n            <Grid container>\n                <Grid item xs={12}>\n                    <Canvas \n                    style={{backgroundColor:\"black\",height:\"500px\"}}\n                    colorManagement={false} \n                    camera={{ fov: 50, position: [0, 0, 30] }} >\n                        <ambientLight />\n                        <Suspense fallback={null}>\n                        {models.map((model,index) => {\n                            return(\n                            <ModelView key={model.id} modelClass={model} position={[0,0,0]}　selectObject={selectObject} activeModelId={activeModelId} controlMode={controlMode}/>\n                        )})}\n                        </Suspense>\n                        <gridHelper />\n                    </Canvas>\n                </Grid>\n                <Grid item xs={6} style={{border: \"1px solid #ffffff\"}}>\n                    <ModelControl key=\"modelcontrol\" models={models} setModels={setModels} activeModelId={activeModelId} setActiveModelId={setActiveModelId} />\n                </Grid>\n                <Grid item xs={6} style={{border: \"1px solid #ffffff\"}}>\n                    <BoneControl key=\"bonecontrol\" models={models} setActiveModelId={setActiveModelId} controlMode={controlMode} setControlMode={setControlMode} />\n                </Grid>\n            </Grid>\n        </>\n    );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}